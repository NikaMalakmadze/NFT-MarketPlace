import{fetchWithAuth}from"./../../../../../static/main/main/js/useAuth.min.js";let likeBtn=document.querySelector(".like-btn"),countElement=likeBtn.querySelector(".like-btn__count"),tokenId=window.location.href.split("/").at(-1),likeStatEl=document.querySelector("#likesStats"),offerModal=document.getElementById("make-offer-modal"),offerBtn=document.getElementById("open-offer-modal"),cancelBtn=document.getElementById("offer-cancel-btn"),submitBtn=document.getElementById("offer-submit-btn"),listBtn=document.getElementById("listBtn"),unlistBtn=document.getElementById("UnlistBtn"),errorsEl=document.querySelector(".errors"),buyEl=document.getElementById("buyEl"),nftLikes=JSON.parse(localStorage.getItem("nftLikes"))??{};async function listUnlistNFT(e){try{var t=await fetchWithAuth(`/api/nft/${tokenId}/`+e,{method:"POST"}),n=await t.json();t.ok?window.location.reload():console.log(n.errors)}catch(e){console.error(e)}}async function sendLike(e){var t=await fetchWithAuth(`/api/nft/${e}/like-nft`),n=await t.json();t.ok&&("liked"===n.message&&(likeBtn.classList.add("like-btn--liked"),t=parseInt(countElement.textContent),countElement.textContent=t+1,likeStatEl.textContent=t+1,nftLikes[e]=!0,localStorage.setItem("nftLikes",JSON.stringify(nftLikes))),"unLiked"===n.message&&(likeBtn.classList.remove("like-btn--liked"),t=parseInt(countElement.textContent),countElement.textContent=t-1,likeStatEl.textContent=t-1,nftLikes[e]=!1,localStorage.setItem("nftLikes",JSON.stringify(nftLikes))),console.log(n.user))}async function sendOffer(){var e=document.getElementById("offer-amount").value,t=document.getElementById("offer-expiry").value;if(!e||parseFloat(e)<=0)alert("Enter a valid ETH amount");else try{var n=await fetchWithAuth(`/api/nft/${tokenId}/offer`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({amount:e,expires_in:t})}),o=await n.json();n.ok?(offerModal.style.display="none",window.location.reload()):(errorsEl.textContent=""+[...o.errors],errorsEl.classList.remove("hidden"))}catch(e){console.error(e)}}async function buy(){var e=document.querySelector(".wallet__balance-amount").textContent.trim().replace("ETH","").replace(" ","");if(!e||parseFloat(e)<=0)alert("Not Enough on balance");else try{var t=await fetchWithAuth(`/api/nft/${tokenId}/buy`,{method:"POST"}),n=await t.json();t.ok?window.location.reload():console.log(n.errors)}catch(e){console.error(e)}}document.addEventListener("DOMContentLoaded",async()=>{!0===nftLikes[tokenId]?likeBtn.classList.add("like-btn--liked"):likeBtn.classList.remove("like-btn--liked");var e=await fetch("/api/nft/price/"+tokenId),t=await e.json();e.ok&&(e=document.querySelector(".nft-item__price-usd"),t=t.price,t=new Intl.NumberFormat("de-DE",{style:"currency",currency:"USD"}).format(t),e.textContent=t,e.classList.remove("skeleton","skeleton-text")),offerBtn?.addEventListener("click",()=>{offerModal.style.display="flex",errorsEl.classList.add("hidden")}),cancelBtn?.addEventListener("click",()=>{offerModal.style.display="none",errorsEl.classList.add("hidden")}),submitBtn?.addEventListener("click",sendOffer),offerModal?.addEventListener("click",e=>{e.target===offerModal&&(offerModal.style.display="none",errorsEl.classList.add("hidden"))}),listBtn?.addEventListener("click",async()=>listUnlistNFT("list")),unlistBtn?.addEventListener("click",async()=>listUnlistNFT("unlist")),buyEl?.addEventListener("click",buy),likeBtn.addEventListener("click",async()=>{await sendLike(tokenId),likeBtn.classList.add("like-btn--animate"),setTimeout(()=>{likeBtn.classList.remove("like-btn--animate")},300)})});
//# sourceMappingURL=nft-item.min.js.map
