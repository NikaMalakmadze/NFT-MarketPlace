import{fetchWithAuth}from"./../../../../../static/main/main/js/useAuth.min.js";let sortDropdownButton=document.querySelector(".sort-dropdown__button"),sortDropdownContent=document.querySelector(".sort-dropdown__content"),sortOptions=document.querySelectorAll(".sort-dropdown__option"),tabs=document.querySelectorAll(".filter-btn"),nftsWrapper=document.querySelector(".collection__items"),loader=document.getElementById("categoryLoader"),collectionId=window.location.href.split("/").at(-1),currentTab=JSON.parse(sessionStorage.getItem("currentCollectionTab"))??1,filters={sortBy:1,currentTab:1};function initApp(){sortDropdownButton&&sortDropdownContent&&(sortDropdownButton.addEventListener("click",function(t){t.stopPropagation();t=this.querySelector(".sort-dropdown__icon");sortDropdownContent.classList.contains("open")?(sortDropdownContent.classList.remove("open"),t.style.transform="rotate(0deg)"):(sortDropdownContent.classList.add("open"),t.style.transform="rotate(180deg)")}),sortOptions.forEach(t=>{t.addEventListener("click",async function(t){t.preventDefault(),t.stopPropagation(),sortDropdownButton.querySelector(".sort-dropdown__text").textContent=this.textContent,sortDropdownContent.classList.remove("open"),sortDropdownButton.querySelector(".sort-dropdown__icon").style.transform="rotate(0deg)",filters.sortBy=Number(this.dataset.id),await getNfts()})}),document.addEventListener("click",function(t){sortDropdownButton.contains(t.target)||sortDropdownContent.contains(t.target)||(sortDropdownContent.classList.remove("open"),sortDropdownButton.querySelector(".sort-dropdown__icon").style.transform="rotate(0deg)")})),initTabs()}function initTabs(){tabs[currentTab-1].classList.add("filter-btn--active"),tabs.forEach(t=>{t.addEventListener("click",nftsByTab)})}async function nftsByTab(t){tabs.forEach(t=>t.classList.remove("filter-btn--active"));t=t.target.closest(".filter-btn"),t.classList.add("filter-btn--active"),t=Number(t.dataset.tabid);currentTab=t,sessionStorage.setItem("currentCollectionTab",t),filters.currentTab=currentTab,loader.style.display="flex",nftsWrapper.style.display="none",await getNfts(filters),setTimeout(()=>{loader.style.display="none",nftsWrapper.style.display="flex"},200)}async function getNfts(){try{var t=await fetchWithAuth(`/api/nft-collection/${collectionId}/get-nfts`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(filters)}),e=await t.json();t.ok?(console.log(e),0===e.nfts.length?noNftsRender():await renderNfts(e.nfts)):e.errors.forEach(t=>console.error(t))}catch(t){console.log(t)}}async function renderNfts(t){var e;nftsWrapper.innerHTML="",console.log(1);for(e of t)e.image=await(async t=>{t=await fetch(`/nft/${t}/get-image`);if(t.ok)return t.url;console.log(t)})(e.token_id),renderNft(e)}function renderNft(t){var e=document.createElement("div");e.classList.add("drop__item"),e.innerHTML=`
        <div class="drop__item-img-wrapper">
          <img
            src="${t.image}"
            alt="${t.name} Image"
            class="drop__item-img"
            loading="lazy"
          />
        </div>
        <div class="drop__item-info">
        <a href='/user/profile/${t.owner_id}'>
          <div class="drop__item-author-wrapper">
            <h6 class="drop__item-author">${t.owner}</h6>
            <svg class="drop__item-author--verified"></svg>
          </div>
        </a>
          <h5 class="drop__item-title">
            <a href='/nft/${t.token_id}'>
              ${t.name}
            </a>
          </h5>
        </div>
        <div class="drop__item-price-wrapper">
          <div class="drop__item-mint-wrapper">
            <p class="drop__item-mint-desc">Minting</p>
            <div class="drop__item-mint-status">
              ${t.is_listed?'<div class="status-dot"></div><p>Now</p>':"<p>No</p>"}
            </div>
          </div>
          <div class="drop__item-price-info">
            <p class="drop__item-price-desc">Price</p>
            <p class="drop__item-price-status">${t.price} ETH</p>
          </div>
        </div>
    `,nftsWrapper.appendChild(e)}function noNftsRender(){nftsWrapper.innerHTML="";var t=document.createElement("div");t.classList.add("no-drops-card"),t.innerHTML=`
    <div class="no-drops-icon">ðŸš«</div>
    <h2>No Latest Drops With That Filter</h2>
    <p>Come back soon â€” new NFTs are dropping regularly!</p>
      `,nftsWrapper.appendChild(t)}document.addEventListener("DOMContentLoaded",async()=>{initApp(),await getNfts()});
//# sourceMappingURL=collection.min.js.map
