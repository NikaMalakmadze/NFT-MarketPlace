import{fetchWithAuth}from"./../../../main/main/js/useAuth.min.js";let filterToggle=document.querySelector(".filter-toggle"),filtersSection=document.querySelector(".filters"),filtersClose=document.querySelector(".filters__close"),dropdownButtons=document.querySelectorAll(".filters__dropdown-button"),clearButton=document.querySelector(".filters__clear-button"),dropItems=document.querySelectorAll(".drop__item"),sortDropdownButton=document.querySelector(".sort-dropdown__button"),sortDropdownContent=document.querySelector(".sort-dropdown__content"),sortOptions=document.querySelectorAll(".sort-dropdown__option"),categoryInputs=document.querySelectorAll(".category-input"),fileTypesInputs=document.querySelectorAll(".file-types-input"),filterInputs=document.querySelectorAll(".filters__input"),listedInputs=document.querySelectorAll(".is-listed-input"),applyBtn=document.querySelector(".filters__apply-button"),searchInput=document.querySelector(".search-box__input"),nftsWrapper=document.querySelector(".drops-grid"),filters={categoryInputs:[],fileTypeInputs:[],isListedInputs:[],sortBy:1,minValue:0,maxValue:-1,search:""},searchTimeout;function initUi(){filterToggle&&filtersSection&&filterToggle.addEventListener("click",function(){window.innerWidth<=768?filtersSection.classList.contains("mobile-open")?(filtersSection.classList.remove("mobile-open"),filterToggle.classList.remove("active"),document.body.style.overflow=""):(filtersSection.classList.add("mobile-open"),filterToggle.classList.add("active"),document.body.style.overflow="hidden"):filtersSection.classList.contains("hidden")?(filtersSection.classList.remove("hidden"),filterToggle.classList.add("active")):(filtersSection.classList.add("hidden"),filterToggle.classList.remove("active"))}),filtersClose&&filtersSection&&filtersClose.addEventListener("click",function(){filtersSection.classList.remove("mobile-open"),filterToggle.classList.remove("active"),document.body.style.overflow=""}),filtersSection&&filtersSection.addEventListener("click",function(e){e.target===filtersSection&&window.innerWidth<=768&&(filtersSection.classList.remove("mobile-open"),filterToggle.classList.remove("active"),document.body.style.overflow="")}),window.addEventListener("resize",function(){768<window.innerWidth?(filtersSection.classList.remove("mobile-open"),document.body.style.overflow=""):(filtersSection.classList.remove("hidden"),filterToggle.classList.remove("active"))}),filterInputs.forEach(e=>{e.addEventListener("input",function(){var e=Number(this.value);"minInput"!==this.id||isNaN(e)||(filters.minValue=e),"maxInput"!==this.id||isNaN(e)||(filters.maxValue=e)})}),categoryInputs.forEach(e=>{e.addEventListener("click",function(){filters.categoryInputs.includes(Number(this.dataset.categoryid))?filters.categoryInputs.splice(filters.categoryInputs.findIndex(e=>e===Number(this.dataset.categoryid)),1):filters.categoryInputs.push(Number(this.dataset.categoryid))})}),fileTypesInputs.forEach(e=>{e.addEventListener("click",function(){filters.fileTypeInputs.includes(Number(this.dataset.filetype))?filters.fileTypeInputs.splice(filters.fileTypeInputs.findIndex(e=>e===Number(this.dataset.filetype)),1):filters.fileTypeInputs.push(Number(this.dataset.filetype))})}),listedInputs.forEach(e=>{e.addEventListener("click",function(){filters.isListedInputs.includes(Number(this.dataset.listed))?filters.isListedInputs.splice(filters.isListedInputs.findIndex(e=>e===Number(this.dataset.listed)),1):filters.isListedInputs.push(Number(this.dataset.listed))})}),applyBtn.addEventListener("click",getNfts),dropdownButtons.forEach(e=>{e.addEventListener("click",function(){var e=this.parentElement.querySelector(".filters__dropdown-content"),t=this.querySelector(".filters__dropdown-icon"),o=e.classList.contains("open");document.querySelectorAll(".filters__dropdown-content").forEach(e=>{e.classList.remove("open")}),document.querySelectorAll(".filters__dropdown-icon").forEach(e=>{e.style.transform="rotate(0deg)"}),o?(e.classList.remove("open"),t.style.transform="rotate(0deg)"):(e.classList.add("open"),t.style.transform="rotate(180deg)")})}),clearButton&&clearButton.addEventListener("click",async function(){var e=document.querySelector(".search-box__input");e&&(e.value=""),document.querySelectorAll('input[type="checkbox"').forEach(e=>e.checked=!1),clearFilters(),await getNfts()}),dropItems.forEach(e=>{e.addEventListener("mouseenter",function(){this.style.transform="translateY(-5px)"}),e.addEventListener("mouseleave",function(){this.style.transform="translateY(-3px)"})}),sortDropdownButton&&sortDropdownContent&&(sortDropdownButton.addEventListener("click",function(e){e.stopPropagation();e=this.querySelector(".sort-dropdown__icon");sortDropdownContent.classList.contains("open")?(sortDropdownContent.classList.remove("open"),e.style.transform="rotate(0deg)"):(sortDropdownContent.classList.add("open"),e.style.transform="rotate(180deg)")}),sortOptions.forEach(e=>{e.addEventListener("click",async function(e){e.preventDefault(),e.stopPropagation(),sortDropdownButton.querySelector(".sort-dropdown__text").textContent=this.textContent,sortDropdownContent.classList.remove("open"),sortDropdownButton.querySelector(".sort-dropdown__icon").style.transform="rotate(0deg)",filters.sortBy=Number(this.dataset.id),await getNfts()})}),document.addEventListener("click",function(e){sortDropdownButton.contains(e.target)||sortDropdownContent.contains(e.target)||(sortDropdownContent.classList.remove("open"),sortDropdownButton.querySelector(".sort-dropdown__icon").style.transform="rotate(0deg)")}),searchInput.addEventListener("input",async()=>{clearTimeout(searchTimeout),searchTimeout=setTimeout(async()=>{filters.search=searchInput.value,await getNfts()},300)}))}function clearFilters(){filters.categoryInputs=[],filters.fileTypeInputs=[],filters.minValue=0,filters.maxValue=-1,filters.search="",document.querySelectorAll(".filters__input").forEach(e=>{e.value=""})}async function getNfts(){try{var e=await fetchWithAuth("/api/nft/filter",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(filters)}),t=await e.json();e.ok?(console.log(t),0===t.nfts.length?noNftsRender():await renderNfts(t.nfts)):(document.querySelectorAll('input[type="checkbox"').forEach(e=>e.checked=!1),clearFilters(),t.errors.forEach(e=>console.error(e)))}catch(e){console.log(e)}}async function renderNfts(e){var t;nftsWrapper.innerHTML="";for(t of e)t.image=await(async e=>{e=await fetch(`/nft/${e}/get-image`);if(e.ok)return e.url;console.log(e)})(t.token_id),renderNft(t)}function renderNft(e){var t=document.createElement("div");t.classList.add("drop__item"),t.innerHTML=`
        <div class="drop__item-img-wrapper">
          <img
            src="${e.image}"
            alt="${e.name} Image"
            class="drop__item-img"
            loading="lazy"
          />
        </div>
        <div class="drop__item-info">
        <a href='/user/profile/${e.owner_id}'>
          <div class="drop__item-author-wrapper">
            <h6 class="drop__item-author">${e.owner}</h6>
            <svg class="drop__item-author--verified"></svg>
          </div>
        </a>
          <h5 class="drop__item-title">
            <a href='nft/${e.token_id}'>
              ${e.name}
            </a>
          </h5>
        </div>
        <div class="drop__item-price-wrapper">
          <div class="drop__item-mint-wrapper">
            <p class="drop__item-mint-desc">Minting</p>
            <div class="drop__item-mint-status">
              ${e.is_listed?'<div class="status-dot"></div><p>Now</p>':"<p>No</p>"}
            </div>
          </div>
          <div class="drop__item-price-info">
            <p class="drop__item-price-desc">Price</p>
            <p class="drop__item-price-status">${e.price} ETH</p>
          </div>
        </div>
    `,nftsWrapper.appendChild(t)}function noNftsRender(){nftsWrapper.innerHTML="";var e=document.createElement("div");e.classList.add("no-drops-card"),e.innerHTML=`
    <div class="no-drops-icon">ðŸš«</div>
    <h2>No Latest Drops With That Filter</h2>
    <p>Come back soon â€” new NFTs are dropping regularly!</p>
      `,nftsWrapper.appendChild(e)}document.addEventListener("DOMContentLoaded",async()=>{initUi(),await getNfts()});
//# sourceMappingURL=drops.min.js.map
