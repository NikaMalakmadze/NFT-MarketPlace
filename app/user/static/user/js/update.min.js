import{fetchWithAuth}from"./../../../../../static/main/main/js/useAuth.min.js";let bioTextarea=document.getElementById("bio"),bioCount=document.getElementById("bio-count"),bannerUpload=document.getElementById("banner-upload"),bannerPreview=document.querySelector(".edit-profile__banner img"),avatarUpload=document.getElementById("avatar-upload"),avatarPreview=document.querySelector(".edit-profile__avatar img"),profileForm=document.querySelector(".edit-profile__form"),userId=window.location.href.split("/").at(-2),maxLength=500,bgFile,logoFile;function initApp(){updateCharacterCount(),bioTextarea.addEventListener("input",updateCharacterCount),bannerUpload.addEventListener("change",function(e){(bgFile=e.target.files[0])&&bgFile.type.match("image.*")&&((e=new FileReader).onload=function(e){bannerPreview.src=e.target.result},e.readAsDataURL(bgFile))}),avatarUpload.addEventListener("change",function(e){(logoFile=e.target.files[0])&&logoFile.type.match("image.*")&&((e=new FileReader).onload=function(e){avatarPreview.src=e.target.result},e.readAsDataURL(logoFile))}),profileForm.addEventListener("submit",async e=>{e.preventDefault();var e=document.getElementById("display-name").value,t=document.getElementById("email").value,a=document.getElementById("bio").value.trim();if(e)if(t)if(a.length>maxLength)alert(`Bio must be ${maxLength} characters or less`);else{var r=new FormData;r.append("display_name",e),r.append("bio",a),r.append("email",t),bgFile&&r.append("profile_background",bgFile),logoFile&&r.append("profile_avatar",logoFile);try{var o=await fetchWithAuth(`/api/user/${userId}/update`,{method:"POST",body:r}),n=await o.json();if(o.ok)window.location.href=`/user/profile/${userId}/update-page`;else{console.error(n.errors);for(var i of n.errors)console.error(i)}}catch(e){console.error(e)}}else alert("Email is required");else alert("Display name is required")})}function updateCharacterCount(){var e=maxLength-bioTextarea.value.length;bioCount.textContent=e,bioCount.style.color=e<0?"#ff3b30":""}document.addEventListener("DOMContentLoaded",initApp);
//# sourceMappingURL=update.min.js.map
